'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = swapNodes;

var _countCrossings = require('./count-crossings');

var _countCrossings2 = _interopRequireDefault(_countCrossings);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function swapNodes(G, order) {
  var improved = true;
  while (improved) {
    improved = false;
    for (var i = 0; i < order.length; ++i) {
      for (var j = 0; j < order[i].length - 1; ++j) {
        var count0 = allCrossings(G, order, i);
        transpose(order[i], j, j + 1);
        var count1 = allCrossings(G, order, i);

        if (count1 < count0) {
          improved = true;
        } else {
          transpose(order[i], j, j + 1); // put back
        }
      }
    }
  }
}

function allCrossings(G, order, i) {
  var count = 0;
  if (i > 0) {
    count += (0, _countCrossings2.default)(G, order[i - 1], order[i]);
  }
  if (i + 1 < order.length) {
    count += (0, _countCrossings2.default)(G, order[i], order[i + 1]);
  }
  return count;
}

function transpose(list, i, j) {
  var tmp = list[i];
  list[i] = list[j];
  list[j] = tmp;
}